# sentry_chassis_controller 底盘控制器

## 核心功能

### **运动控制**

接收 `/cmd_vel` 话题的速度指令（线速度 `vx`、`vy`，角速度 `omega`），通过 PID 控制算法驱动底盘的舵机（转向）和轮子（转速），实现底盘的全向运动。

### **里程计发布**

通过轮子运动状态计算底盘位姿，发布 `/odom` 话题和 TF 变换（`odom` → `base_link`），提供实时位置和姿态信息。

### **动态调参**

支持通过 `dynamic_reconfigure` 动态调整 8 个 PID 控制器（4 个舵机 + 4 个轮子）的参数（P、I、D、积分限幅等），无需重启控制器即可优化控制性能。

### **加速度限制**

可选配置最大加速度参数，限制底盘速度变化率，避免急加减速导致的不稳定。

### **速度模式切换**

支持两种速度指令模式：

- 底盘坐标系模式：指令基于底盘自身坐标系（前进、横移、旋转）。
- 全局坐标系模式：通过 TF 变换将全局坐标系下的指令转换为底盘本地指令，适合导航场景。

### **重置功能**

订阅 `/gazebo/reset_world` 话题，接收重置信号时重置 PID 控制器状态和里程计信息。

## 技术细节

### 硬件接口

基于 `hardware_interface::EffortJointInterface` 控制关节力矩

### 关节控制

控制 4 个舵机关节（转向）和 4 个轮子关节（转速），关节名称与 `rm_description_for_task` 模型匹配。

### 配置说明

- **控制器参数**：修改 `config/controllers.yaml` 配置硬件参数（轮距、轮径等）和PID 参数、速度模式、最大加速度等控制参数
- **动态调参**：启动 `rqt_reconfigure` 实时调整 PID 参数：

## Teleop 包

#### 向底盘发送速度指令（`/cmd_vel` 话题），实现远程控制

#### 操作说明

- 按键 `i`：前进（增加 `vx`）
- 按键 `,`（逗号）：后退（减小 `vx`）
- 按键 `j`：左移（增加 `vy`）
- 按键 `l`：右移（减小 `vy`）
- 按键 `u`/`o`：左旋转 / 右旋转（调整 `omega`）
- 按键 `k`：锁住
- 按键 `q`：退出程序